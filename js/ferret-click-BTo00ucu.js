import{B as u}from"./base-minigame-BKAltXfh.js";import{C as p}from"./click-target-CElWWxe_.js";import{T as m}from"./timer-BgpETdvb.js";import{C as h}from"./index-c0fuZDJO.js";class x extends u{async start(){this.isActive=!0,this.gameState.timeStarted=this.scene.time.now,this.setupEventSpace(),this.setupClickTarget(),this.setupTimer(),this.showIntroAnimation()}setupEventSpace(){this.createBackground(2763306,parseInt(this.config.color.replace("#","0x"))),this.createTitle("CLICK THE FERRET!"),this.createInstructions("Catch the ferret before it escapes!"),this.createFerretTrail()}createFerretTrail(){for(let e=0;e<6;e++){const t=this.scene.add.text(this.eventArea.x+Math.random()*this.eventArea.width,this.eventArea.y+40+Math.random()*(this.eventArea.height-80),"🐾",{fontSize:"10px",alpha:.3});this.trackElement(t)}}setupClickTarget(){const e=new p(this.scene,{requiredClicks:1,timeout:this.config.timeout,clickFeedback:!0,onTargetClick:t=>this.ferretCaught(t),onComplete:()=>this.success(),onTimeout:()=>this.timeout()});this.addMechanic(e),e.start(),this.createFerret(e)}createFerret(e){const t=this.eventArea.x+this.eventArea.width/2,s=this.eventArea.y+this.eventArea.height/2,a=this.scene.add.container(t,s);this.trackElement(a);const i=this.scene.add.ellipse(0,0,50,30,parseInt(this.config.color.replace("#","0x"))).setStrokeStyle(3,0),r=this.scene.add.circle(-12,-5,4,0),n=this.scene.add.circle(12,-5,4,0),o=this.scene.add.circle(0,3,3,16738740),c=this.scene.add.ellipse(-25,0,30,15,parseInt(this.config.color.replace("#","0x"))).setStrokeStyle(2,0);a.add([c,i,r,n,o]);const l={x:this.eventArea.x+30,y:this.eventArea.y+40,width:this.eventArea.width-60,height:this.eventArea.height-80};e.createBounceTarget(t,s,l,a,{velocityX:Phaser.Math.Between(100,150)*(Math.random()>.5?1:-1),velocityY:Phaser.Math.Between(100,150)*(Math.random()>.5?1:-1),metadata:{type:"ferret"}});const d=this.scene.tweens.add({targets:c,angle:[-10,10],duration:300,repeat:-1,yoyo:!0});this.trackTween(d);const g=this.scene.tweens.add({targets:[r,n],scaleY:[1,.1,1],duration:1500,repeat:-1,delay:Math.random()*2e3});this.trackTween(g),this.ferret=a}setupTimer(){const e=new m(this.scene,{duration:this.config.timeout,position:{x:this.eventArea.x+this.eventArea.width-50,y:this.eventArea.y+20},style:"circle",color:16738740,onTimeout:()=>this.timeout()});this.addMechanic(e),e.start()}update(e,t){super.update(e,t),this.mechanics.forEach(s=>{s.updateMovingTargets&&s.updateMovingTargets(e,t)}),this.ferret&&this.ferret.velocityX&&(this.ferret.angle=this.ferret.velocityX*.1)}showIntroAnimation(){this.ferret&&(this.ferret.setScale(0),this.scene.tweens.add({targets:this.ferret,scale:1,duration:500,ease:"Bounce.easeOut"})),this.scene.time.delayedCall(300,()=>{const e=this.scene.add.text(this.eventArea.x+this.eventArea.width/2,this.eventArea.y+this.eventArea.height-25,"Fun fact: Ferrets sleep 18-20 hours a day!",{...h.TEXT_STYLES.MICRO,color:"#FFB6C1",fontStyle:"italic"}).setOrigin(.5).setAlpha(0);this.trackElement(e),this.scene.tweens.add({targets:e,alpha:[0,1,0],duration:2e3})})}ferretCaught(e){e.bounceEnabled=!1,this.scene.tweens.add({targets:e,scale:[1,1.3,1],angle:[e.angle,e.angle+360],duration:500,ease:"Back.easeOut"}),this.createCelebrationEffect(e.x,e.y),this.scene.chatManager&&this.scene.chatManager.addSystemMessage("Ferret caught! *happy ferret noises*",h.COLORS.FERRET),this.playSound("ferret_happy",{volume:.5})}createCelebrationEffect(e,t){for(let a=0;a<8;a++){const i=this.scene.add.text(e,t,"💖",{fontSize:"12px"});this.trackElement(i);const r=Math.PI*2/8*a;this.scene.tweens.add({targets:i,x:e+Math.cos(r)*40,y:t+Math.sin(r)*40,alpha:0,scale:[1,.5],duration:800,onComplete:()=>i.destroy()})}const s=this.scene.add.text(e,t-30,"CAUGHT!",{fontSize:"16px",fontFamily:'"Press Start 2P"',color:"#FF69B4",stroke:"#000000",strokeThickness:2}).setOrigin(.5);this.trackElement(s),this.scene.tweens.add({targets:s,y:t-50,alpha:0,duration:1e3})}static getMetadata(){return{id:"ferret-click",name:"Ferret Click",description:"Click the bouncing ferret before it escapes",difficulty:2,category:"click",mechanics:["click-target","timer","movement"],estimatedDuration:3e3,author:"PirateSoftware",tags:["ferret","click","moving-target","cute"]}}}export{x as FerretClickMinigame};
