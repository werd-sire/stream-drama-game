import{B as l}from"./base-minigame-BKAltXfh.js";import{C as o}from"./click-target-CElWWxe_.js";import{T as d}from"./timer-BgpETdvb.js";import{C as c,J as m}from"./index-c0fuZDJO.js";class p extends l{constructor(e,s,a){super(e,s,a),this.stage="brb",this.searchTerm=Phaser.Utils.Array.GetRandom(this.config.searchTerms)}async start(){this.isActive=!0,this.gameState.timeStarted=this.scene.time.now,this.setupEventSpace(),this.setupGlobalTimeout(),this.showBRBStage()}setupEventSpace(){this.createBackground(1710618,parseInt(this.config.color.replace("#","0x")))}setupGlobalTimeout(){const e=new d(this.scene,{duration:this.config.timeout||7e3,position:{x:this.eventArea.x+this.eventArea.width-50,y:this.eventArea.y+20},style:"bar",color:16711680,onTimeout:()=>this.timeout()});this.addMechanic(e),e.start()}showBRBStage(){const e=this.eventArea.x+this.eventArea.width/2,s=this.eventArea.y+this.eventArea.height/2;this.stageTitle=this.createTitle("BATHROOM BREAK!"),this.instructions=this.scene.add.text(e,s-20,"Tell chat you'll BRB!",{...c.TEXT_STYLES.UI_SMALL}).setOrigin(.5),this.trackElement(this.instructions);const a=new o(this.scene,{requiredClicks:1,allowMultipleTargets:!1,onComplete:()=>this.handleBRBClick()}),i=this.scene.add.rectangle(e,s+20,140,50,parseInt(c.COLORS.ACCENT.replace("#","0x"))).setStrokeStyle(3,0);this.trackElement(i);const t=this.scene.add.text(e,s+20,`CLICK FOR
BRB`,{...c.TEXT_STYLES.UI_SMALL,color:"#000000",stroke:"#FFFFFF",strokeThickness:2,align:"center"}).setOrigin(.5);this.trackElement(t);const r=a.createTarget(e,s+20,i,{hoverScale:1.1});r.buttonText=t,i.on("pointerover",()=>t.setScale(1.1)),i.on("pointerout",()=>t.setScale(1)),this.addMechanic(a),a.start()}handleBRBClick(){this.stageTitle.setVisible(!1),this.instructions.setVisible(!1),this.scene.chatManager&&this.scene.chatManager.addSystemMessage("Streamer: BRB bathroom!",c.COLORS.ACCENT),this.mechanics.forEach(e=>this.removeMechanic(e)),this.showPhoneStage()}showPhoneStage(){const e=this.eventArea.x+this.eventArea.width/2;this.stageTitle.setText("Phone Time!").setVisible(!0);const s=this.scene.add.rectangle(e,this.eventArea.y+this.eventArea.height/2,160,120,3355443).setStrokeStyle(3,0);this.trackElement(s);const a=this.scene.add.rectangle(e,this.eventArea.y+this.eventArea.height/2,150,100,16777215);this.trackElement(a);const i=this.scene.add.rectangle(e,this.eventArea.y+40,140,20,15658734).setStrokeStyle(1,10066329);this.trackElement(i);const t=this.scene.add.text(e,this.eventArea.y+40,this.searchTerm,{fontSize:"8px",color:"#000000",fontFamily:"Arial"}).setOrigin(.5);this.trackElement(t);const r=new o(this.scene,{requiredClicks:1,allowMultipleTargets:!1,onComplete:()=>this.showSearchResults()}),n=this.scene.add.text(e+65,this.eventArea.y+40,"ðŸ”",{fontSize:"12px"}).setOrigin(.5);this.trackElement(n),r.createTarget(e+65,this.eventArea.y+40,n),this.addMechanic(r),r.start()}showSearchResults(){this.mechanics.forEach(t=>this.removeMechanic(t));const e=this.eventArea.x+this.eventArea.width/2,s=this.eventArea.y+60,a=["Gaming Wiki - Complete Guide",`â­ ${this.searchTerm} - Solution`,"Forum Discussion Thread","Video Walkthrough"],i=new o(this.scene,{requiredClicks:1,allowMultipleTargets:!1,onComplete:()=>this.handleSuccess()});a.forEach((t,r)=>{const n=s+r*15;if(t.includes("â­")){const h=this.scene.add.text(e-70,n,t,{fontSize:"7px",color:"#0000FF",fontFamily:"Arial"}).setOrigin(0,.5);this.trackElement(h),i.createTarget(e-70,n,h)}else{const h=this.scene.add.text(e-70,n,t,{fontSize:"7px",color:"#000000",fontFamily:"Arial"}).setOrigin(0,.5);this.trackElement(h)}}),this.addMechanic(i),i.start()}handleSuccess(){const e=this.scene.add.text(this.eventArea.x+this.eventArea.width/2,this.eventArea.y+this.eventArea.height/2,"BACK TO STREAM!",{...c.TEXT_STYLES.UI_SMALL,color:"#00FF00",stroke:"#000000",strokeThickness:3}).setOrigin(.5).setAlpha(0);this.trackElement(e),this.scene.tweens.add({targets:e,alpha:1,scale:[.5,1.2,1],duration:500,ease:"Back.easeOut"}),this.scene.time.delayedCall(800,()=>{m.play(this.scene,"bathroom_break",{volume:.5}),this.success()})}static getMetadata(){return{id:"bathroom-break",name:"Bathroom Break",description:"Quick bathroom break adventure",difficulty:1,category:"multi-stage",mechanics:["click-target"],estimatedDuration:6e3,author:"PirateSoftware",tags:["brb","phone","search","multi-stage"]}}}export{p as BathroomBreakMinigame};
