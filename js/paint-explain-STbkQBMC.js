import{C as s}from"./index-c0fuZDJO.js";import{B as c}from"./base-event-BLT1_Wdv.js";class l extends c{constructor(t,e,i){super(t,e,i),this.clickCount=0,this.lastClickTime=0,this.expectingLeftClick=!0,this.diagramParts=[]}start(){this.setupEventSpace(),this.createPaintInterface(),this.setupDiagramParts(),this.setupClickHandlers()}cleanup(){this.scene.input&&this.scene.input.mouse&&typeof this.scene.input.mouse.enableContextMenu=="function"&&this.scene.input.mouse.enableContextMenu(),super.cleanup()}setupEventSpace(){const t=this.scene.add.graphics();t.fillStyle(0,1),t.fillRect(this.eventArea.x,this.eventArea.y,this.eventArea.width,this.eventArea.height),t.lineStyle(3,parseInt(this.config.color.replace("#","0x")),1),t.strokeRect(this.eventArea.x,this.eventArea.y,this.eventArea.width,this.eventArea.height),this.trackElement(t)}createPaintInterface(){const t=this.scene.add.rectangle(this.eventArea.x,this.eventArea.y,this.eventArea.width,20,170).setOrigin(0);this.trackElement(t);const e=this.scene.add.text(this.eventArea.x+5,this.eventArea.y+2,"Paint - Explaining Code.bmp",{...s.TEXT_STYLES.MICRO,color:"#FFFFFF"});this.trackElement(e);const i=this.scene.add.text(this.eventArea.x+this.eventArea.width/2,this.eventArea.y+this.eventArea.height-20,"Alternate LEFT/RIGHT clicks to explain!",{...s.TEXT_STYLES.MICRO,color:"#FFFFFF"}).setOrigin(.5);this.trackElement(i);const r=this.scene.add.rectangle(this.eventArea.x+10,this.eventArea.y+this.eventArea.height-35,this.eventArea.width-20,8,3355443).setOrigin(0);this.trackElement(r),this.progressBar=this.scene.add.rectangle(this.eventArea.x+10,this.eventArea.y+this.eventArea.height-35,0,8,65280).setOrigin(0),this.trackElement(this.progressBar),this.clickIndicator=this.scene.add.text(this.eventArea.x+this.eventArea.width/2,this.eventArea.y+35,"LEFT CLICK",{...s.TEXT_STYLES.UI_SMALL,color:"#00FF00"}).setOrigin(.5),this.trackElement(this.clickIndicator),this.drawingGraphics=this.scene.add.graphics(),this.trackElement(this.drawingGraphics)}setupDiagramParts(){const t=this.eventArea.x+this.eventArea.width/2,e=this.eventArea.y+this.eventArea.height/2;this.diagramParts=[()=>{this.drawingGraphics.lineStyle(2,16777215),this.drawingGraphics.strokeRect(t-80,e-20,50,30)},()=>{const i=this.scene.add.text(t-55,e-5,"INPUT",{...s.TEXT_STYLES.MICRO,color:"#FFFFFF"}).setOrigin(.5);this.trackElement(i)},()=>{this.drawingGraphics.lineStyle(2,16777215),this.drawingGraphics.beginPath(),this.drawingGraphics.moveTo(t-30,e-5),this.drawingGraphics.lineTo(t-10,e-5),this.drawingGraphics.strokePath(),this.drawingGraphics.moveTo(t-10,e-5),this.drawingGraphics.lineTo(t-15,e-10),this.drawingGraphics.moveTo(t-10,e-5),this.drawingGraphics.lineTo(t-15,e),this.drawingGraphics.strokePath()},()=>{this.drawingGraphics.lineStyle(2,16777215),this.drawingGraphics.strokeRect(t-5,e-20,60,30)},()=>{const i=this.scene.add.text(t+25,e-5,"PROCESS",{...s.TEXT_STYLES.MICRO,color:"#FFFFFF"}).setOrigin(.5);this.trackElement(i)},()=>{this.drawingGraphics.lineStyle(2,16777215),this.drawingGraphics.beginPath(),this.drawingGraphics.moveTo(t+55,e-5),this.drawingGraphics.lineTo(t+75,e-5),this.drawingGraphics.strokePath()},()=>{this.drawingGraphics.lineStyle(2,16777215),this.drawingGraphics.strokeRect(t+80,e-20,50,30)},()=>{const i=this.scene.add.text(t+105,e-5,"OUTPUT",{...s.TEXT_STYLES.MICRO,color:"#FFFFFF"}).setOrigin(.5);this.trackElement(i)},()=>{const i=this.scene.add.text(t,e+30,"IT'S THAT SIMPLE!",{...s.TEXT_STYLES.UI_SMALL,color:"#FFFF00"}).setOrigin(.5);this.trackElement(i)}]}setupClickHandlers(){const t=this.scene.add.rectangle(this.eventArea.x,this.eventArea.y,this.eventArea.width,this.eventArea.height,0,0).setOrigin(0).setInteractive();this.trackElement(t),t.on("pointerdown",e=>{if(!this.scene||!this.progressBar||!this.clickIndicator)return;const i=this.scene.time.now;if(i-this.lastClickTime>this.config.clickWindow&&this.clickCount>0){this.resetProgress();return}const r=e.leftButtonDown(),n=e.rightButtonDown();if(this.expectingLeftClick&&!r||!this.expectingLeftClick&&!n){this.wrongClick();return}this.clickCount++,this.lastClickTime=i,this.expectingLeftClick=!this.expectingLeftClick,this.updateProgress(),this.revealDiagramPart(),this.clickCount>=this.config.clicksRequired&&this.success()}),this.scene.input&&this.scene.input.mouse&&typeof this.scene.input.mouse.disableContextMenu=="function"&&this.scene.input.mouse.disableContextMenu()}updateProgress(){if(!this.progressBar||!this.clickIndicator||!this.scene)return;const t=this.clickCount/this.config.clicksRequired;this.progressBar.width=(this.eventArea.width-20)*t,this.clickIndicator.setText(this.expectingLeftClick?"LEFT CLICK":"RIGHT CLICK"),this.clickIndicator.setColor(this.expectingLeftClick?"#00FF00":"#FF00FF"),this.scene.tweens.add({targets:this.clickIndicator,scale:[1.2,1],duration:100})}revealDiagramPart(){const t=this.diagramParts.length/this.config.clicksRequired,e=Math.floor((this.clickCount-1)*t);e<this.diagramParts.length&&this.diagramParts[e]&&this.diagramParts[e]()}wrongClick(){!this.clickIndicator||!this.scene||(this.clickIndicator.setColor("#FF0000"),this.scene.tweens.add({targets:this.clickIndicator,scale:[1,1.5,1],duration:300,onComplete:()=>{this.clickIndicator&&this.clickIndicator.setColor(this.expectingLeftClick?"#00FF00":"#FF00FF")}}),this.resetProgress())}resetProgress(){if(!this.progressBar||!this.clickIndicator||!this.drawingGraphics)return;this.clickCount=0,this.expectingLeftClick=!0,this.progressBar.width=0,this.clickIndicator.setText("LEFT CLICK"),this.clickIndicator.setColor("#00FF00"),this.drawingGraphics.clear();const t=[];this.elements.forEach(e=>{e.type==="Text"&&e!==this.clickIndicator&&e.text!=="Paint - Explaining Code.bmp"&&e.text!=="Alternate LEFT/RIGHT clicks to explain!"&&t.push(e)}),t.forEach(e=>{const i=this.elements.indexOf(e);i>-1&&this.elements.splice(i,1),e.destroy()})}}export{l as PaintExplainEvent};
